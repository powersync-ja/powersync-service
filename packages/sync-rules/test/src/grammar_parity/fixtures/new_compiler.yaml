query:
  accepted:
    - sql: SELECT * FROM users
    - sql: SELECT u.* FROM users AS u JOIN orgs AS o ON u.org_id = o.id WHERE o.owner_id = auth.user_id()

  rejected_syntax:
    - sql: SELECT u.* FROM users u FULL JOIN orgs o ON u.org_id = o.id
      err: JOIN

    - sql: SELECT u.* FROM users u INNER JOIN orgs USING (org_id)
      err: USING

    - sql: SELECT * FROM users ORDER BY id
      err: ORDER BY

    - sql: SELECT * FROM users WHERE id = $1
      err: parameters are not allowed

    - sql: DELETE FROM users
      err: SELECT

  rejected_semantic:
    - sql: SELECT u.*, auth.parameter('x') FROM users AS u
      err: connection parameter

with:
  accepted:
    - sql: SELECT id FROM orgs WHERE owner_id = auth.user_id()

  rejected_syntax:
    # CTE output columns cannot include wildcard
    - sql: SELECT * FROM orgs
      err: '*'
